<div class="mw-body-content" id="bodyContent">
<div class="noprint" id="siteSub">From Stardew Valley Wiki</div>
<div id="contentSub"></div>
<div id="contentSub2"></div>
<div id="jump-to-nav"></div>
<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
<a class="mw-jump-link" href="#searchInput">Jump to search</a>
<div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output"><style data-mw-deduplicate="TemplateStyles:r177397">.mw-parser-output #talkheadertitle{background-color:#03A007;text-align:center;color:white;text-shadow:0px 2px #00321f;font-size:120%}.mw-parser-output #talkheaderbody{width:80%;margin:0 auto 1em auto;border:1px solid rgb(170,170,170);background-color:rgba(255,255,255,0.58);color:rgb(0,0,0)}.mw-parser-output #talkheadertitle a{color:white}</style>
<table id="talkheaderbody">
<tbody><tr>
<th colspan="2" id="talkheadertitle">This talk page is for discussing <a class="external text" href="//stardewvalleywiki.com/Template:Qualityprice" rel="nofollow">Template:Qualityprice</a>.
</th></tr>
<tr>
<td>
<ul><li>Sign and date your posts by typing four tildes (~~~~).</li>
<li>Put new text below old text.</li></ul>
</td>
<td>
<ul><li>Be polite.</li>
<li>Assume good faith.</li>
<li>Don't delete discussions.</li></ul>
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Calculation_Change_from_April_29_2021">Calculation Change from April 29 2021</span></h2>
<p>Please explain the nature of the calculation problem that resulted in incorrect amounts, and give an example. Also explain why this change corrects the problem. It seems that the truncation must be shifted by one decimal place so that intermediate values have one digit greater accuracy than before. Why is only one digit sufficient? And why is it necessary?
</p><p>From day one on this wiki there were always problems with results produced by the templates, until NebulousMaestress finally fixed them about 5 months ago. What is it about v1.5 that has introduced something that worked completely in v1.4? <a href="/User:Giles" title="User:Giles">Giles</a> (<a href="/User_talk:Giles" title="User talk:Giles">talk</a>) 05:12, 30 April 2021 (UTC)
</p>
<dl><dd>See <strike>Template talk:Artisan</strike> below. <a href="/User:Zendowolf" title="User:Zendowolf">Zendowolf</a> (<a href="/User_talk:Zendowolf" title="User talk:Zendowolf">talk</a>) 04:41, 1 May 2021 (UTC)
<dl><dd>Ah, I see. Thanks. This is truly strange. <a href="/User:Giles" title="User:Giles">Giles</a> (<a href="/User_talk:Giles" title="User talk:Giles">talk</a>) 02:38, 9 May 2021 (UTC)</dd></dl></dd></dl>
<h2><span class="mw-headline" id="Wrong_prices">Wrong prices</span></h2>
<p>(Note: I copied this discussion over from Template talk:Artisan, since Template:Artisan has been marked for deletion. <a href="/User:Zendowolf" title="User:Zendowolf">Zendowolf</a> (<a href="/User_talk:Zendowolf" title="User talk:Zendowolf">talk</a>) 22:08, 5 May 2021 (UTC))
</p><p>I noticed on some pickles that the pricing is off by 1 gold (e.g. Garlic and Ginger). For example Garlic regular is 60g. Pickled Garlic is 2 x 60 + 50 = 170. Still good. But then the artisan: multiplier 170 x 1.4 = 238. But the formula and thus infobox spits out <b>237g</b> Weird! <a href="/User:Dubesor" title="User:Dubesor">Dubesor</a> (<a href="/User_talk:Dubesor" title="User talk:Dubesor">talk</a>) 03:49, 28 April 2021 (UTC)
</p>
<dl><dd>This problem has plagued the wiki since its inception!  On the old wiki, a user rewrote <a href="/Template:Infobox" title="Template:Infobox">Template:infobox</a> to supposedly fix the problem... I guess it didn't work for all cases.  The underlying problem is that the wiki can't replicate C# code, and the equation for calculating artisan sell prices is a bit convoluted in the game.  You can look at the <a class="external text" href="https://stardewcommunitywiki.com/Template_talk:Artisan" rel="nofollow">old talk page</a> to see the equation at that time.  Anyway, it's a long-standing problem with no simple fix.  :(  <a href="/User:Margotbean" title="User:Margotbean">margotbean</a> (<a href="/User_talk:Margotbean" title="User talk:Margotbean">talk</a>) 18:00, 28 April 2021 (UTC)
<dl><dd>The old talk page claims that [* 14 / 10.0] is a workaround for [* 1.4], but that's only used here for wine, not pickles. <a href="/User:Zendowolf" title="User:Zendowolf">Zendowolf</a> (<a href="/User_talk:Zendowolf" title="User talk:Zendowolf">talk</a>) 19:54, 28 April 2021 (UTC)
<dl><dd>None of that got implemented, afaik.  It's just background on the problem.  <a href="/User:Margotbean" title="User:Margotbean">margotbean</a> (<a href="/User_talk:Margotbean" title="User talk:Margotbean">talk</a>) 20:54, 28 April 2021 (UTC)
<dl><dd>I realize now this template is not the problem. It returns a correct value when called. The problem appears to be in <a href="/Template:Qualityprice" title="Template:Qualityprice">Template:Qualityprice</a>. If I call that template directly, I get an incorrect value. So it looks like it's not necessary to decipher all the complicated stuff <a href="/Template:Infobox" title="Template:Infobox">Template:Infobox</a> is doing. <a href="/User:Zendowolf" title="User:Zendowolf">Zendowolf</a> (<a href="/User_talk:Zendowolf" title="User talk:Zendowolf">talk</a>) 21:27, 28 April 2021 (UTC)</dd>
<dd>Update: I have a version of that template that works with the few values I've given it (it returns 238 with the above inputs, for example). Not a very comprehensive  test, really. Should I push it out to the world and see if it breaks anything? (See <a href="/User:Zendowolf/Sandbox/Qualityprice" title="User:Zendowolf/Sandbox/Qualityprice">User:Zendowolf/Sandbox/Qualityprice</a>) <a href="/User:Zendowolf" title="User:Zendowolf">Zendowolf</a> (<a href="/User_talk:Zendowolf" title="User talk:Zendowolf">talk</a>) 21:50, 28 April 2021 (UTC)
<dl><dd>I'm sorry, I thought I read that you didn't do comprehensive testing, but wanted to know if you should push an update that could affect thousands of pages in 12 languages.  I must be dreaming or something.  ðŸ¤”<a href="/User:Margotbean" title="User:Margotbean">margotbean</a> (<a href="/User_talk:Margotbean" title="User talk:Margotbean">talk</a>) 02:43, 29 April 2021 (UTC)
<dl><dd>No, I was not suggesting that we propagate an untested change to all 12 languages.</dd>
<dd>Here's the thing, I do not have the resources to do what I would consider a comprehensive test: set up a test server and copy everything over, before making the change there and testing it. Can you set up a test server?</dd>
<dd>The alternative, copying all the relevant templates down to a sandbox area and editing them all to point to each other rather than the real templates, is too messy to contemplate. You don't pay me enough to do that.</dd>
<dd>So I took a step back. It's a really simple change. The chances of it causing a problem seem extremely small. The possibility of recovery if there is a problem seem very high: Wikimedia is designed to revert changes quickly and easily. So we make the changes to the English-language wiki, at a time when we can monitor it. Make sure everything is as expected and there are no unforeseen side-effects. If it breaks something, we revert it. Back to the drawing board. If it works as expected, maybe we give it a little time to reveal any surprises. Then in due course, we propagate it to the other languages.</dd>
<dd>A less cautious person probably would've already made the changes. It probably would be fine.<a href="/User:Zendowolf" title="User:Zendowolf">Zendowolf</a> (<a href="/User_talk:Zendowolf" title="User talk:Zendowolf">talk</a>) 07:50, 29 April 2021 (UTC)
<dl><dd>The last time I made a change to the equation, I fixed half the items and broke the other half.  It was a wash.  This is why I require comprehensive testing, more than just 4 items. You don't need to set up a test server to do comprehensive testing.  There are two methods:</dd></dl>
<ol><li>There is a link at the bottom of every template page that says "Preview page with this template" so you can preview changes before committing them.</li>
<li>The old-fashioned way is to add "noinclude" tags at the bottom of the template, then add all items affected, then preview the change and check them all for accuracy.</li></ol>
<dl><dd>In this way, we can be sure we're not just shifting the "off by one" problem from existing items to other items that are now correct.  <a href="/User:Margotbean" title="User:Margotbean">margotbean</a> (<a href="/User_talk:Margotbean" title="User talk:Margotbean">talk</a>) 18:47, 29 April 2021 (UTC)
<dl><dd>I did a fair bit of regression testing using the method you described. The only differences I found were cases where the immediate problem had been fixed. Then I committed the changes because to abandon them at that point would invalidate the tests. <a href="/User:Zendowolf" title="User:Zendowolf">Zendowolf</a> (<a href="/User_talk:Zendowolf" title="User talk:Zendowolf">talk</a>) 21:50, 29 April 2021 (UTC)
<dl><dd>GJ on fixing that! I was honestly too confused how the error came to be, before I posted the the topic it took me like 10 minutes to even find a suiting template that could be responsible :D <a href="/User:Dubesor" title="User:Dubesor">Dubesor</a> (<a href="/User_talk:Dubesor" title="User talk:Dubesor">talk</a>) 08:19, 6 May 2021 (UTC)</dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl>
<h2><span class="mw-headline" id="Update">Update</span></h2>
<p>This module should be updated since they added <a href="/Dehydrator" title="Dehydrator">Dehydrator</a> and <a href="/Fish_Smoker" title="Fish Smoker">Fish Smoker</a>. <a href="/User:%E7%BE%A4%E6%98%9F%E4%B9%8B%E5%B0%98" title="User:ç¾¤æ˜Ÿä¹‹å°˜">ç¾¤æ˜Ÿä¹‹å°˜</a> (<a class="new" href="/mediawiki/index.php?title=User_talk:%E7%BE%A4%E6%98%9F%E4%B9%8B%E5%B0%98&amp;action=edit&amp;redlink=1" title="User talk:ç¾¤æ˜Ÿä¹‹å°˜ (page does not exist)">talk</a>) 14:40, 13 April 2024 (UTC)
</p>
<dl><dd>That sounds like a fun project, and I need to get back into coding. Where do I start? I can try hacking out some simple tables on my userspace for testing layout, but I don't think I am even allowed to modify the template without margotbean's permission, or copy the infobox template to my userspace. (I mean, what could I do, when I have time, probably tuesday) <a href="/User:Spriteless" title="User:Spriteless">Spriteless</a> (<a class="new" href="/mediawiki/index.php?title=User_talk:Spriteless&amp;action=edit&amp;redlink=1" title="User talk:Spriteless (page does not exist)">talk</a>) 13:55, 15 April 2024 (UTC)</dd></dl>
<dl><dd><dl><dd>Read and digest <a href="/Help:Editing" title="Help:Editing">Help:Editing</a> first. Become familiar with mediawiki syntax. After that, if you have time to change all 12 languages, then check back and we can discuss. Thanks! <a href="/User:Margotbean" title="User:Margotbean">margotbean</a> (<a href="/User_talk:Margotbean" title="User talk:Margotbean">talk</a>) 17:59, 15 April 2024 (UTC)</dd></dl></dd></dl>
<p>I'd like to bring up updating this template and its associated Module:Calcsellprice again, since the Stardew Valley Fair Grange Display, Forage, and Fruits tables cannot be updated to 1.6 without it. (I also think the Fish table may benefit from an Artisan Good Sale Price column, but that one already has a ton of columns.) From what I see, the Module page could have 
</p><p><code>
elseif ((item == "dried mushrooms") or (item == "dried fruit")) then
		artisanprice = math.floor(25 + (baseprice * 7.5))
</code></p><p><code>elseif ((item == "smoked fish") then
		artisanprice = (baseprice * 2)
</code>
</p><p>added below the roe calculation. Additionally, Raisins have a flat price, so 
</p><p><code>
elseif (item == "raisins") then artisanprice = 600
</code>
</p><p>could be added to the note below the Truffle Oil line (though that 600 would just be manually inputted onto the appropriate pages anyways).
</p><p>As for the Template, I think the only update that could be useful is adding Dried Fruit, Dried Mushrooms, and Raisins to the lines that suppress their silver/gold/iridium sale prices, as the Dehydrator only ever produces normal quality items. Also, since Smoked Fish takes the Fisher and Angler professions into account, the relevant profession modifiers are pm=1.4 (Artisan), pm=1.75 (Artisan + Fisher), and pm=2.1 (Artisan + Angler). I don't believe any change I've listed here will break the template/module, but I'll leave that up to admin discretion since they're used in so many places. <a href="/User:Bluestblur" title="User:Bluestblur">Bluestblur</a> (<a href="/User_talk:Bluestblur" title="User talk:Bluestblur">talk</a>) 00:00, 7 June 2024 (UTC)
</p>
<!-- 
NewPP limit report
Cached time: 20250302092918
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.026 seconds
Real time usage: 0.027 seconds
Preprocessor visited node count: 80/1000000
Postâ€expand include size: 702/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 8/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip postâ€expand size: 442/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   12.851      1 Template:Talkheader
100.00%   12.851      1 -total
-->
<!-- Saved in parser cache with key enwiki:pcache:idhash:13021-0!canonical and timestamp 20250302092918 and revision id 172202
 -->
</div></div><div class="printfooter">Retrieved from "<a dir="ltr" href="https://stardewvalleywiki.com/mediawiki/index.php?title=Template_talk:Qualityprice&amp;oldid=172202">https://stardewvalleywiki.com/mediawiki/index.php?title=Template_talk:Qualityprice&amp;oldid=172202</a>"</div>
<div class="catlinks" data-mw="interface" id="catlinks"><div class="mw-normal-catlinks" id="mw-normal-catlinks"><a href="/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/Category:Talk_pages" title="Category:Talk pages">Talk pages</a></li></ul></div></div>
</div>